<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ドックンバトル - タイトル</title>
    <link rel="stylesheet" href="./index.css" />
  </head>
  <body>
    <div class="stars" id="stars"></div>
    <div class="title-container">
      <h1 class="game-title">ドックンバトル</h1>
      <p class="game-subtitle">～心拍数で戦うシューティングゲーム～</p>

      <div class="heart-animation">
        <div class="heart"></div>
      </div>

      <div class="menu-buttons">
        <a href="game.html" class="menu-button start-button">ゲームスタート</a>
        <a href="ranking.html" class="menu-button ranking-button">ランキング</a>
      </div>

      <div class="instructions">
        <h3>ゲームの特徴</h3>
        <ul>
          <li>心拍数で弾を発射する新感覚シューティング</li>
          <li>Bluetooth心拍センサーと連動</li>
          <li>心拍数を上げてより多くの弾を撃とう！</li>
          <li>効果音: 魔王魂様</li>
        </ul>
      </div>
    </div>

    <script>
      // 星空エフェクト
      function createStars() {
        const starsContainer = document.getElementById("stars");
        const numberOfStars = 100;

        for (let i = 0; i < numberOfStars; i++) {
          const star = document.createElement("div");
          star.className = "star";
          star.style.left = Math.random() * 100 + "%";
          star.style.top = Math.random() * 100 + "%";
          star.style.animationDelay = Math.random() * 3 + "s";
          star.style.animationDuration = Math.random() * 2 + 2 + "s";
          starsContainer.appendChild(star);
        }
      }

      // 効果音プリロード（あれば）
      function preloadSounds() {
        try {
          const sounds = ["music.mp3", "dead.mp3", "get-damage.mp3"];
          sounds.forEach((sound) => {
            const audio = new Audio(sound);
            audio.preload = "auto";
            audio.volume = 0.02;
          });
          console.log("効果音プリロード完了");
        } catch (error) {
          console.log("効果音プリロードエラー:", error);
        }
      }

      // ボタンクリック効果音
      function playClickSound() {
        try {
          // 簡単なクリック音をWeb Audio APIで生成
          const audioContext = new (window.AudioContext ||
            window.webkitAudioContext)();
          const oscillator = audioContext.createOscillator();
          const gainNode = audioContext.createGain();

          oscillator.connect(gainNode);
          gainNode.connect(audioContext.destination);

          oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
          oscillator.frequency.exponentialRampToValueAtTime(
            400,
            audioContext.currentTime + 0.1
          );

          gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
          gainNode.gain.exponentialRampToValueAtTime(
            0.01,
            audioContext.currentTime + 0.1
          );

          oscillator.start(audioContext.currentTime);
          oscillator.stop(audioContext.currentTime + 0.1);
        } catch (error) {
          console.log("クリック音生成エラー:", error);
        }
      }

      // キーボードナビゲーション
      function setupKeyboardNavigation() {
        const buttons = document.querySelectorAll(".menu-button");
        let currentIndex = 0;

        // 初期フォーカス
        buttons[currentIndex]?.focus();

        document.addEventListener("keydown", (e) => {
          switch (e.key) {
            case "ArrowUp":
              e.preventDefault();
              currentIndex =
                (currentIndex - 1 + buttons.length) % buttons.length;
              buttons[currentIndex].focus();
              break;
            case "ArrowDown":
              e.preventDefault();
              currentIndex = (currentIndex + 1) % buttons.length;
              buttons[currentIndex].focus();
              break;
            case "Enter":
              e.preventDefault();
              playClickSound();
              buttons[currentIndex].click();
              break;
          }
        });
      }

      // 初期化
      document.addEventListener("DOMContentLoaded", () => {
        createStars();
        preloadSounds();
        setupKeyboardNavigation();

        // ボタンクリック時の効果音
        document.querySelectorAll(".menu-button").forEach((button) => {
          button.addEventListener("click", playClickSound);
        });

        console.log("ドックンバトル タイトル画面 読み込み完了");
      });

      // アニメーション最適化
      document.addEventListener("visibilitychange", () => {
        if (document.hidden) {
          // ページが非表示の時はアニメーションを停止
          document.body.style.animationPlayState = "paused";
        } else {
          // ページが表示されたらアニメーションを再開
          document.body.style.animationPlayState = "running";
        }
      });
    </script>
  </body>
</html>
